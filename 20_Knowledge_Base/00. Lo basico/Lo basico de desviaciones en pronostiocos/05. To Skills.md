puedes convertir lo riesgo de desbalanceo y los otros riesgos e un SKILLs.MD que los presente y la solucion para lograr evitarlo.

El concepto skills se refiere al estandard de Anthropics que ha sido adpotado por los tools de IA de generacion

Para integrar estos conceptos en un flujo de trabajo de generación de código compatible con los estándares de **AI Skills (o MCP - Model Context Protocol)** adoptados por herramientas modernas, el archivo debe estructurarse como una definición de capacidades, restricciones y heurísticas de resolución.

A continuación, presento el archivo `SKILLS.md` diseñado para que un agente de IA (como los que operan en .NET 10/C# 14) identifique y mitigue estos riesgos en proyectos de series temporales térmicas.

---

# SKILLS.md: Thermal Excursion Predictive Analytics

## Purpose

Este skill define los protocolos para identificar y mitigar riesgos críticos en el rendimiento predictivo de modelos de excursión térmica, específicamente optimizado para implementaciones en **ML.NET** y **ONNX**.

---

## 1. Risk: Class Imbalance (Rare Event Bias)

**Description:** Las excursiones térmicas representan <5% del dataset. El modelo tiende a optimizar la pérdida hacia la clase mayoritaria (falsos negativos masivos).

### Solutions:

- **Technique:** `Cost-Sensitive Learning`.
    
- **Implementation:** Asignar pesos inversamente proporcionales a la frecuencia en el pipeline de `IDataView`.
    
- **C# Action:** ```csharp
    
    // Calcule weight = total_samples / (class_count * 2)
    
    pipeline.Append(mlContext.BinaryClassification.Trainers.SdcaLogisticRegression(weightColumnName: "Weight"));
    
- **Validation:** Prohibir el uso de `Accuracy`. Utilizar `AreaUnderPrecisionRecallCurve` y `F1-Score`.
    

---

## 2. Risk: Concept & Data Drift

**Description:** Degradación del rendimiento debido a cambios en el aislamiento del contenedor (Concept) o descalibración de sensores IoT (Data).

### Solutions:

- **Technique:** `Statistical Distance Monitoring`.
    
- **Implementation:** Comparar la distribución de las características de entrada (_Features_) en producción frente al set de entrenamiento usando **Kolmogorov-Smirnov**.
    
- **C# Action:** Implementar un servicio de telemetría que dispare un `RetrainWorkflow` si la métrica de drift supera un umbral ($\alpha > 0.05$).
    

---

## 3. Risk: Temporal Dependency (Thermal Inertia)

**Description:** Ignorar que la temperatura actual está ligada a la anterior, tratando cada log como independiente (i.i.d. violation).

### Solutions:

- **Technique:** `Sliding Window Feature Engineering`.
    
- **Implementation:** Crear vectores de características que incluyan rezagos ($t-1, t-n$) y derivadas (velocidad de cambio).
    
- **C# Action:**
    
    C#
    
    ```
    // Feature Engineering en C# 14 usando Memory<T> para eficiencia
    var rollingMean = window.Average();
    var deltaTemp = current - previous;
    ```
    

---

## 4. Risk: Sensor Noise & Missing Data

**Description:** Pérdida de paquetes en tránsito o picos de voltaje que generan anomalías falsas en la serie temporal.

### Solutions:

- **Technique:** `Signal Smoothing & Imputation`.
    
- **Implementation:** Aplicar **Filtros de Kalman** o Medias Móviles Exponenciales (EMA) antes de la inferencia ONNX.
    
- **C# Action:**
    
    C#
    
    ```
    pipeline.Append(mlContext.Transforms.ReplaceMissingValues("Features", replacementMode: MissingValueReplacingEstimator.ReplacementMode.Mean));
    ```
    

---

## 5. Risk: Feature Leakage (Hindsight Bias)

**Description:** Incluir variables que solo se conocen _después_ de que ocurre la excursión (ej. "Estado de alarma activado") dentro del set de entrenamiento.

### Solutions:

- **Technique:** `Causal Auditing`.
    
- **Constraint:** Solo se permiten variables conocidas en el tiempo $T_{predict}$.
    
- **Check:** Auditar que ninguna variable en el modelo ONNX tenga una correlación $> 0.98$ con el Label, lo cual indica posible fuga.
    

---

## Evaluation Checklist for AI Agents

- [ ] ¿El modelo usa una columna de pesos para balancear el 5% de eventos?
    
- [ ] ¿Se ha incluido la temperatura ambiente externa como variable exógena?
    
- [ ] ¿El horizonte de predicción es operacionalmente útil ($> 30$ min)?
    
- [ ] ¿Se ha exportado el modelo a ONNX con metadatos de versión para trazabilidad de drift?
    

---

¿Te gustaría que generara una clase de C# que implemente automáticamente el cálculo de estos **Class Weights** basándose en un archivo CSV de entrenamiento?